/*Macle 24.6.0 jssdk v0.0.13  Fri Jun 28 2024*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).jssdk=t()}(this,(function(){"use strict";var e,t;const n=null===(t=null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent)||void 0===t?void 0:t.toLocaleLowerCase(),r=-1!==(null==n?void 0:n.indexOf("android")),i=Symbol("currentRoute"),o=Symbol("isInitd"),a=Symbol("tabBar"),s=Symbol("canNavigateTo"),c="__ma__global__",l={[i]:"",[o]:!1,[a]:null,[s]:!0};function u(e,t){l[e]=t}function d(e){return window[c][e]}window[c]=l;const E={MiniProgram:{NAVIGATE_TO:"navigateTo",NAVIGATE_BACK:"navigateBack",REDIRECT_TO:"redirectTo",SWITCH_TAB:"switchTab",RE_LAUNCH:"reLaunch",POST_MESSAGE:"postMessage",CLOSE:"close"},Native:{CHOOSE_IMAGE:"chooseImage",GET_LOCAL_IMG_DATA:"getLocalImgData",GET_LOCATION:"getLocation",PREVIEW_IMAGE:"previewImage",OPEN_DOCUMENT:"openDocument",GET_STORAGE:"getStorage",SET_STORAGE:"setStorage",REMOVE_STORAGE:"removeStorage",CLEAR_STORAGE:"clearStorage",GET_NETWORK_TYPE:"getNetworkType",SCAN_CODE:"scanCode",GET_STATUS_BAR_HEIGHT:"getStatusBarHeight",CAPSULE_STYLE:"capsuleStyle",HIDE_LOADING:"hideLoading",SHOW_LOADING:"showLoading",SHOW_TOAST:"showToast",GET_SMALL_APP_INFO:"getsmallappinfo",GO_TO_BROWSER:"gotoBrowser",SAVE_FILE_TO_PHONE:"saveFileToPhone",SAVE_IMAGE:"saveImage",SAVE_BASE64_IMAGE:"saveBase64Image",CHOOSE_CONTACT:"chooseContact",IS_ONLINE:"isOnline",REQUEST:"request",UPLOAD_FILE:"uploadFile",DOWNLOAD_FILE:"downloadFile",REPORT_EVENT:"reportEvent",REPORT_PERFORMANCE:"reportPerformance",REPORT_LOG:"reportLog",SUBMIT_REPORT:"submitReport",PLAY_VOICE:"playVoice",PLAY_AUDIO:"playAudio",GET_BACKGROUND_FETCH_DATA:"getBackgroundFetchData",GET_LAUNCH_OPTIONS_SYNC:"getLaunchOptionsSync",GET_SYSTEM_INFO_SYNC:"getSystemInfoSync",NAVIGATE_TO_MINI_PROGRAM:"navigateToMiniProgram",EXIT_MINI_PROGRAM:"exitMiniProgram",STOP_AUOID:"stopVoice",GET_OPEN_USER_INFO:"getOpenUserInfo",GET_AUTH_CODE:"getAuthCode",OPEN_BLUETOOTH_ADAPTER:"openBluetoothAdapter",CLOSE_BLUETOOTH_ADAPTER:"closeBluetoothAdapter",START_BLUETOOTH_DEVICES_DISCOVERY:"startBluetoothDevicesDiscovery",STOP_BLUETOOTH_DEVICES_DISCOVERY:"stopBluetoothDevicesDiscovery",CREATE_BLE_CONNECTION:"createBLEConnection",CLOSE_BLE_CONNECTION:"closeBLEConnection",GET_BLE_DEVICE_SERVICES:"getBLEDeviceServices",GET_BLE_DEVICE_CHARACTERISTICS:"getBLEDeviceCharacteristics",READ_BLE_CHARACTERISTIC_VALUE:"readBLECharacteristicValue",WRITE_BLE_CHARACTERISTIC_VALUE:"writeBLECharacteristicValue",ON_BLUETOOTH_DEVICE_FOUND:"ON_BT_DEVICE_FOUND",OFF_BLUETOOTH_DEVICE_FOUND:"offBluetoothDeviceFound",TRADE_PAY:"tradePay"}},v=void 0!==window.parent.__simulatorConfig__;const f=new class{constructor(){this.eventMap=new Map,this.callbackMap=new Map}on(e,t){var n;const r=function(...e){try{t.apply(void 0,e)}catch(e){console.error(e)}};this.callbackMap.set(t,r),this.eventMap.has(e)?null===(n=this.eventMap.get(e))||void 0===n||n.add(r):this.eventMap.set(e,new Set([r]))}off(e,t){const n=this.eventMap.get(e);if(n)if(t){const e=this.callbackMap.get(t);n.delete(e)}else n.clear()}get(e){return this.eventMap.get(e)}emit(e,t){const n=this.eventMap.get(e);if(n)for(const e of n)e.call(this,t)}},_={};let O=0;const T={};function N(e,t={},n){const i=JSON.stringify(t),o=++O;_[o]=n,function(e,t,n){v?window.simulatorWebkit.messageHandlers.invoke.postMessage({command:e,inputParams:t,callbackId:n,type:"legacy"}):r?window.viewLayerNative.invoke(e,t,n):window.webkit.messageHandlers.invoke.postMessage({command:e,inputParams:t,callbackId:n})}(e,i,o)}function m(e,t){const n=JSON.stringify(Object.assign({command:e},t));return window.prompt(n)}function I(e,t,n={}){const r={};for(const e in t)"function"==typeof t[e]&&(r[e]=t[e],delete t[e]);N(e,t,((e,t)=>{var i,o,a,s,c,l,u,d,E,v,f;const _=0===Number(e),O=[1,-1].includes(Number(e));_?(null===(i=null==n?void 0:n.beforeAll)||void 0===i||i.call(n,t),null===(o=null==n?void 0:n.beforeSuccess)||void 0===o||o.call(n,t),null===(a=r.success)||void 0===a||a.call(r,t),null===(s=null==n?void 0:n.afterSuccess)||void 0===s||s.call(n,t)):O?(null===(c=null==n?void 0:n.beforeFail)||void 0===c||c.call(n,t),null===(l=r.fail)||void 0===l||l.call(r,t),null===(u=null==n?void 0:n.afterFail)||void 0===u||u.call(n,t)):(null===(d=null==n?void 0:n.beforeSuccess)||void 0===d||d.call(n,t),null===(E=null==r?void 0:r.preload)||void 0===E||E.call(r,t)),(_||O)&&(null===(v=r.complete)||void 0===v||v.call(r,t),null===(f=null==n?void 0:n.afterAll)||void 0===f||f.call(n,t))}))}function p(e,t={}){const n=JSON.stringify(t);v?window.simulatorWebkit.messageHandlers.notifyNative.postMessage({command:e,inputParams:n,type:"legacy"}):r?window.viewLayerNative.notifyNative(e,n):window.webkit.messageHandlers.notifyNative.postMessage({command:e,inputParams:n})}function A(e,t){T[e]=t}const S={invoke:N,invokeMethod:I,notifyNative:p,invokeSync:m,onNativeNotify:function(e,t,n){!function(e,t,n){"function"==typeof e&&e(n,t||n.webviewId||"")}(T[e],t,n)},onBasicEvent:A,offBasicEvent:function(e){T[e]=void 0}};window.logicLayer=S;const g={},b="ma_custom_event_";function C(e,t){g[`${b}${e}`]=t}function R(e,t={}){const n=JSON.stringify(t);h(`${b}${e}`,n)}function h(e,t){v?window.simulatorWebkit.messageHandlers.notifyNative.postMessage({eventName:e,paramsString:t,type:"legacy"}):r?window.viewLayerNative.notifyNative(e,t):window.webkit.messageHandlers.notifyNative.postMessage({eventName:e,paramsString:t})}const L={invoke:N,invokeSync:m,invokeMethod:I,beforeInvoke:function(e,t={},n={}){return t.success||t.fail||t.complete?I(e,t,n):new Promise(((r,i)=>{t.success=r,t.fail=i,I(e,t,n)}))},notifyNative:p,subscribe:C,webSubscribe:function(e,t){g[e]=t},publish:R,webPublish:function(e,t={}){h(e,JSON.stringify(t))},onBasicEvent:A};function P(){if(!d(o)){u(o,!0);try{L.onBasicEvent(E.Native.ON_BLUETOOTH_DEVICE_FOUND,(function(e){f.emit(E.Native.ON_BLUETOOTH_DEVICE_FOUND,e)})),C("getCurrentRoute",(e=>{u(i,e.route),u(a,e.tabBar),u(s,void 0===e.canNavigateTo||e.canNavigateTo)})),R("getCurrentRoute")}catch(e){}}}class y extends Error{constructor(e,t){if(super(`${e} fail, ${t}`),this.fileName="",this.lineNumber=1,this.columnNumber=-1,this.name=this.constructor.name,!this.stack)return;const[,n,r=1,i]=this.stack.match(/\/([\/\w-_\.]+\.js):(\d*):(\d*)/)||[];this.fileName=n,this.lineNumber=Number(r),this.columnNumber=Number(i)}}const D="MACLE_ERROR_LOG",U={normalError(e){console.error(null==e?void 0:e.message),p(D,{key:e.key||"MacleApiError",errorStack:e.message,apiName:e.apiName,keywords:e.keywords,fwkVersion:"",file:e.file,line:e.line,column:e.column,timestamp:Date.now()})}};function G(e,t,n=!0){let r,i,o=t;if(n&&(o=function(e){const t=e.split("?");return t[0]+=".html",void 0===t[1]?t[0]:`${t[0]}?${t[1]}`}(o)),o.startsWith("/"))return o.substr(1);if(o.startsWith("./"))return G(e,o.substr(2),!1);const a=o.split("/");for(r=0,i=a.length;r<i&&".."===a[r];r++);a.splice(0,r);const s=e.length>0?e.split("/"):[];return s.splice(s.length-r-1,r+1),s.concat(a).join("/")}function B(e){const t=e.split("?"),[n,r]=t;if(!r)return e;const i=r.split("&").reduce(((e,t)=>{if("string"==typeof t&&t.length>0){const n=t.split("="),r=n[0],i=n[1];e[r]=i}return e}),Object.create(null)),o=[];for(const e in i)o.push(e+"="+encodeURIComponent(i[e]));return o.length>0?n+"?"+o.join("&"):e}function k(e,t){const n=d(a);if(null===n)return!0;t.url.startsWith("/")&&(t.url=t.url.slice(1));const r=(i=t.url,null==n?void 0:n.list.find((e=>0===i.indexOf(e.pagePath))));var i;return e!==E.MiniProgram.NAVIGATE_TO&&e!==E.MiniProgram.REDIRECT_TO||!r?!(e===E.MiniProgram.SWITCH_TAB&&!r)||(H(e,`${e}: can not ${e} to a non-tabbar page`),!1):(H(e,`${e}: can not ${e} to a tabbar page`),!1)}function M(e){return/^(http|https):\/\/.*/i.test(e)}function w(e){return Object.prototype.toString.call(e).split(" ")[1].split("]")[0]}function H(e,t){const n=new y(e,t);return U.normalError({message:n.message,file:n.fileName,line:n.lineNumber,column:n.columnNumber}),n}function V(e,t){if(F(e)&&W(t)&&Object.keys(t).length){const n=e.split("?")[0],r=e.split("?")[1],i={};r&&r.split("&").forEach((e=>{e.length&&(i[e.split("=")[0]]=e.split("=")[1])}));const o={};for(const[e,n]of Object.entries(t))W(n)?o[e]=JSON.stringify(n):o[e]=n;return`${n}?${function(e){if(!W(e))return e;const t=[];for(const n in e)try{t.push(`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`)}catch(r){t.push(`${n}=${e[n]}`)}return t.join("&")}(function(e,t){for(const[n,r]of Object.entries(t))e[n]=r;return e}(i,o))}`}return e}function j(e){return"Array"===w(e)}function F(e){return"String"===w(e)}function W(e){return"Object"===w(e)}function $(e,t,n){var r;const i=H(e,n);if(!t.success&&!t.fail&&!t.complete)return new Promise(((e,n)=>{t.fail=n,t.fail({errMsg:i.message})}));for(const e of["fail","complete"]){null===(r=t[e])||void 0===r||r.call(t,{errMsg:i.message})}return null}function Y(e,t,n,r="parameter",i=!1){let o="";const a=w(t),s=w(n);if(a!==s)return o=`${r} should be ${s} instead of ${a};`,t.invalidParamObj=$(e,t,o),!1;if("Object"!==s)return!0;for(const[e,r]of Object.entries(n))if(Object.prototype.hasOwnProperty.call(t,e)||i){const n=w(r),i=w(t[e]);n!==i&&(o+=`${e} should be ${n} instead of ${i};`)}return!o||(t.invalidParamObj=$(e,t,o),!1)}function x(e,t,n,r={},i="parameter"){const o=function(e,t,n={}){var r;const i=Object.assign({},t);for(let o in t)void 0===e[o]&&(null===(r=n[o])||void 0===r?void 0:r.optional)&&(delete i[o],delete n[o]);return i}(t,n,r);return!!Y(e,t,o,i,!0)&&function(e,t,n,r={},i="parameter"){let o="";for(let e in r){const n=t[e],{nonempty:i}=r[e];if(i){const t=j(n)&&!n.length,r=F(n)&&!n.trim();(t||r)&&(o+=`parameter error: ${e} cannot be empty;`)}}if(o)return t.invalidParamObj=$(e,t,o),!1;return!0}(e,t,0,r,i)}function J(e,t,n){for(const[r,i]of Object.entries(e))if(!i||"string"==typeof i&&0===i.trim().length)return t.invalidParamObj=$(n,t,`parameter error: ${r} should be required instead of Undefined or empty.`),!1;return!0}var K=Object.freeze({__proto__:null,close:function(){L.invokeMethod(E.MiniProgram.CLOSE)},getEnv:function(e){e({miniprogram:"miniprogram"===window.__ma_environment})},navigateBack:function(e){const t=Object.assign({delta:1},e);L.beforeInvoke(E.MiniProgram.NAVIGATE_BACK,t)},navigateTo:function(e){if(!e.url)return $(E.MiniProgram.NAVIGATE_TO,e,"parameter error:parameter.url should be String instead of Undefined.");const t=e;t.url=G(d(i),t.url),t.url=B(t.url),k(E.MiniProgram.NAVIGATE_TO,t)&&L.beforeInvoke(E.MiniProgram.NAVIGATE_TO,t)},postMessage:function(e){L.beforeInvoke(E.MiniProgram.POST_MESSAGE,e)},reLaunch:function(e){if(!e.url)return $(E.MiniProgram.RE_LAUNCH,e,"parameter error:parameter.url should be String instead of Undefined.");const t=e;t.url=G(d(i),t.url),t.url=B(t.url),k(E.MiniProgram.RE_LAUNCH,t)&&L.beforeInvoke(E.MiniProgram.RE_LAUNCH,t)},redirectTo:function(e){if(!e.url)return $(E.MiniProgram.REDIRECT_TO,e,"parameter error:parameter.url should be String instead of Undefined.");const t=e;t.url=G(d(i),t.url),t.url=B(t.url),k(E.MiniProgram.REDIRECT_TO,t)&&L.beforeInvoke(E.MiniProgram.REDIRECT_TO,t)},switchTab:function(e){if(!e.url)return $(E.MiniProgram.SWITCH_TAB,e,"parameter error:parameter.url should be String instead of Undefined.");const t=e;t.url=G(d(i),t.url),t.url=B(t.url),k(E.MiniProgram.SWITCH_TAB,t)&&L.beforeInvoke(E.MiniProgram.SWITCH_TAB,t)}});function q(e,t={},n){n&&"function"==typeof n?L.invoke(e,t,((t,r)=>{0===Number(t)?n(r):H(e,`${r.errMsg}`)})):H(e,"callback should be function!")}const X={nonempty:!0};const Q={optional:!0};const z={nonempty:!0},Z={optional:!0};var ee=Object.freeze({__proto__:null,callNativeAPI:q,capsuleStyle:function(e){if(Y(E.Native.CAPSULE_STYLE,e,{style:0})){return-1===[0,1].indexOf(e.style)?$(E.Native.CAPSULE_STYLE,e,`parameter error: invalid style ${e.style}`):L.beforeInvoke(E.Native.CAPSULE_STYLE,e)}return e.invalidParamObj},chooseContact:function(e){return L.beforeInvoke(E.Native.CHOOSE_CONTACT,e)},chooseImage:function(e){const t=Object.assign({count:9,sizeType:["original","compressed"],sourceType:["album","camera"]},e);return L.beforeInvoke(E.Native.CHOOSE_IMAGE,t)},clearStorage:function(e){return L.beforeInvoke(E.Native.CLEAR_STORAGE,e)},closeBLEConnection:function(e){return J({deviceId:e.deviceId},e,E.Native.CLOSE_BLE_CONNECTION)&&Y(E.Native.CLOSE_BLE_CONNECTION,e,{deviceId:""})?L.beforeInvoke(E.Native.CLOSE_BLE_CONNECTION,e):e.invalidParamObj},closeBluetoothAdapter:function(e){return L.beforeInvoke(E.Native.CLOSE_BLUETOOTH_ADAPTER,e)},createBLEConnection:function(e){if(!J({deviceId:e.deviceId},e,E.Native.CREATE_BLE_CONNECTION))return e.invalidParamObj;if(x(E.Native.CREATE_BLE_CONNECTION,e,{deviceId:"",timeout:0},{timeout:{optional:!0}})){const t=Object.assign({timeout:3e4},e);return L.beforeInvoke(E.Native.CREATE_BLE_CONNECTION,t)}return e.invalidParamObj},downloadFile:function(e){return e.url?M(e.url)?L.beforeInvoke(E.Native.DOWNLOAD_FILE,e):$(E.Native.DOWNLOAD_FILE,e,`parameter error: invalid url ${e.url}`):$(E.Native.DOWNLOAD_FILE,e,"parameter error: parameter.url should be String instead of Undefined.")},exitMiniProgram:function(e){return x(E.Native.EXIT_MINI_PROGRAM,e,{clearCache:!1},{clearCache:Q})?L.beforeInvoke(E.Native.EXIT_MINI_PROGRAM,e):e.invalidParamObj},getAuthCode:function(e){if(!e.scopes)return $(E.Native.GET_AUTH_CODE,e,"parameter error:parameter.scopes should be Array<string> instead of Undefined.");if(Y(E.Native.GET_AUTH_CODE,e,{scopes:["1"]})){const t=function(e){const t=["AUTH_BASE","AUTH_USER","SEND_MESSAGE","USER_NICKNAME","USER_NAME","USER_LOGIN_ID","PLAINTEXT_USER_LOGIN_ID","HASH_LOGIN_ID","USER_AVATAR","USER_GENDER","USER_BIRTHDAY","USER_NATIONALITY","USER_CONTACTINFO","USER_ADDRESS","PLAINTEXT_MOBILE_PHONE"];return e.filter((e=>-1===t.indexOf(`${e}`.toUpperCase())))}(e.scopes);return t.length>0?$(E.Native.GET_AUTH_CODE,e,`parameter error: invalid scopes ${t}`):L.beforeInvoke(E.Native.GET_AUTH_CODE,e)}return e.invalidParamObj},getBLEDeviceCharacteristics:function(e){return J({deviceId:e.deviceId,serviceId:e.serviceId},e,E.Native.GET_BLE_DEVICE_CHARACTERISTICS)&&Y(E.Native.GET_BLE_DEVICE_CHARACTERISTICS,e,{deviceId:"",serviceId:""})?L.beforeInvoke(E.Native.GET_BLE_DEVICE_CHARACTERISTICS,e):e.invalidParamObj},getBLEDeviceServices:function(e){return J({deviceId:e.deviceId},e,E.Native.GET_BLE_DEVICE_SERVICES)&&Y(E.Native.GET_BLE_DEVICE_SERVICES,e,{deviceId:""})?L.beforeInvoke(E.Native.GET_BLE_DEVICE_SERVICES,e):e.invalidParamObj},getBackgroundFetchData:function(e){return e.fetchType?L.beforeInvoke(E.Native.GET_BACKGROUND_FETCH_DATA,e):$(E.Native.GET_BACKGROUND_FETCH_DATA,e,"parameter error:parameter.fetchType should be string instead of Undefined.")},getLaunchOptionsSync:function(){const e=L.invokeSync(E.Native.GET_LAUNCH_OPTIONS_SYNC);return e&&JSON.parse(e)},getLocalImgData:function(e){return(null==e?void 0:e.path)?L.beforeInvoke(E.Native.GET_LOCAL_IMG_DATA,e):$(E.Native.GET_LOCAL_IMG_DATA,e,"parameter error:parameter.path should be String instead of Undefined.")},getLocation:function(e){const t=Object.assign({useFetchData:!1},e);return L.beforeInvoke(E.Native.GET_LOCATION,t)},getNetworkType:function(e){return L.beforeInvoke(E.Native.GET_NETWORK_TYPE,e)},getOpenUserInfo:function(e){return L.beforeInvoke(E.Native.GET_OPEN_USER_INFO,e)},getStatusBarHeight:function(e){return L.beforeInvoke(E.Native.GET_STATUS_BAR_HEIGHT,e)},getStorage:function(e){if(!(null==e?void 0:e.key))return $(E.Native.GET_STORAGE,e,"parameter error:parameters.key should be String instead of Undefined.");const t=Object.assign({encrypt:!1},e);return L.beforeInvoke(E.Native.GET_STORAGE,t)},getSystemInfoSync:function(){const e=L.invokeSync(E.Native.GET_SYSTEM_INFO_SYNC);return e&&JSON.parse(e)},getsmallappinfo:function(e){return L.beforeInvoke(E.Native.GET_SMALL_APP_INFO,e)},gotoBrowser:function(e){return e.openUrl?Y(E.Native.GO_TO_BROWSER,e,{openUrl:""})?L.beforeInvoke(E.Native.GO_TO_BROWSER,e):e.invalidParamObj:$(E.Native.GO_TO_BROWSER,e,"parameter error:parameter.openUrl should be String instead of Undefined.")},hideLoading:function(e){return L.beforeInvoke(E.Native.HIDE_LOADING,e)},isOnline:function(){return window.navigator.onLine},native:function(e,t){const n=t||{};return new Promise(((t,r)=>{q(e,n,(e=>{t(e)}))}))},navigateToMiniProgram:function(e){return e.appId?Y(E.Native.NAVIGATE_TO_MINI_PROGRAM,e,{appId:"",path:"",params:""})?!e.path&&e.params?$(E.Native.NAVIGATE_TO_MINI_PROGRAM,e,"parameter error: there is params but no path."):L.beforeInvoke(E.Native.NAVIGATE_TO_MINI_PROGRAM,e):e.invalidParamObj:$(E.Native.NAVIGATE_TO_MINI_PROGRAM,e,"parameter error:parameter.appId should be String instead of Undefined.")},offBluetoothDeviceFound:function(){f.off(E.Native.ON_BLUETOOTH_DEVICE_FOUND)},onBluetoothDeviceFound:function(e){"Function"===w(e)?f.on(E.Native.ON_BLUETOOTH_DEVICE_FOUND,e):H("onBluetoothDeviceFound","callback is not a function")},openBluetoothAdapter:function(e){return L.beforeInvoke(E.Native.OPEN_BLUETOOTH_ADAPTER,e)},openDocument:function(e){return(null==e?void 0:e.filePath)?e.fileType&&-1===["doc","docx","xls","xlsx","ppt","pptx","pdf"].indexOf(e.fileType)?$(E.Native.OPEN_DOCUMENT,e,"parameter error:parameter.fileType is invalid value."):L.beforeInvoke(E.Native.OPEN_DOCUMENT,e):$(E.Native.OPEN_DOCUMENT,e,"parameter error:parameters.filePath should be String instead of Undefined.")},playAudio:function(e){return e.url?M(e.url)?L.beforeInvoke(E.Native.PLAY_VOICE,e):$(E.Native.PLAY_AUDIO,e,`parameter error: invalid url ${e.url}`):$(E.Native.PLAY_AUDIO,e,"parameter error:parameter.url should be String instead of Undefined.")},previewImage:function(e){return(null==e?void 0:e.urls)?L.beforeInvoke(E.Native.PREVIEW_IMAGE,e):$(E.Native.PREVIEW_IMAGE,e,"parameter error:parameter.urls should be Array instead of Undefined.")},readBLECharacteristicValue:function(e){return J({deviceId:e.deviceId,serviceId:e.serviceId,characteristicId:e.characteristicId},e,E.Native.READ_BLE_CHARACTERISTIC_VALUE)&&Y(E.Native.READ_BLE_CHARACTERISTIC_VALUE,e,{deviceId:"",serviceId:"",characteristicId:""})?L.beforeInvoke(E.Native.READ_BLE_CHARACTERISTIC_VALUE,e):e.invalidParamObj},removeStorage:function(e){return(null==e?void 0:e.key)?L.beforeInvoke(E.Native.REMOVE_STORAGE,e):$(E.Native.REMOVE_STORAGE,e,"parameter error:parameter.key should be String instead of Undefined.")},reportEvent:function(e){return x(E.Native.REPORT_EVENT,e,{eventId:""},{eventId:X})?L.notifyNative(E.Native.REPORT_EVENT,e):e.invalidParamObj},reportLog:function(e){if(!e.log||!W(e.log)&&!F(e.log))return $(E.Native.REPORT_LOG,e,"parameter error:  parameter.log should be Object or String instead of Undefined.");if(e.level&&-1===["debug","info","error"].indexOf(e.level))return $(E.Native.REPORT_LOG,e,`parameter error:  invalid level ${e.level}`);W(e.log)&&(e.log=JSON.stringify(e.log));const t=Object.assign({level:"info"},e);return L.notifyNative(E.Native.REPORT_LOG,t)},reportPerformance:function(e){return e.reportEvent&&F(e.reportEvent)?e.reportParams&&W(e.reportParams)?L.notifyNative(E.Native.REPORT_PERFORMANCE,e):$(E.Native.REPORT_PERFORMANCE,e,"parameter error:  parameter.reportParams should be Object instead of Undefined."):$(E.Native.REPORT_PERFORMANCE,e,"parameter error:  parameter.reportEvent should be String instead of Undefined.")},request:function(e){const t=function(e){let t="";e.url||(t="parameter error: parameter.url should be String instead of Undefined.");M(e.url)||(t=`parameter error: invalid url ${e.url}`);e.data&&"Function"===w(e.data)&&(t="parameter error: data should not be Function.");return t}(e);if(t)return $(E.Native.REQUEST,e,t);e.header&&!W(e.header)&&(e.header={}),e.header=function(e){const t={};for(const n in e)switch(w(e[n])){case"String":t[n]=e[n];break;case"Number":case"Boolean":t[n]=`${e[n]}`;break;default:t[n]=JSON.stringify(e[n])}return t}(e.header||{});for(const t in e.header)if("content-type"===t.toLowerCase()){const n=e.header[t];delete e.header[t],e.header[t.toLowerCase()]=n}e.method=e.method?e.method.toUpperCase():"GET",e.dataType=e.dataType||"json",e.header["content-type"]=e.header["content-type"]||"application/json";let n="";e.data&&(n=W(e.data)?JSON.stringify(e.data):e.data),"GET"===e.method&&(e.url=V(e.url,e.data||{}));const r=Object.assign({data:n},e);return L.beforeInvoke(E.Native.REQUEST,r,{beforeSuccess(t){if("json"===e.dataType)try{t.data&&F(t.data)&&(t.data=JSON.parse(t.data))}catch(t){H(E.Native.REQUEST,`JSON parse data error from ${e.url}`)}}})},saveBase64Image:function(e){return e.base64?Y(E.Native.SAVE_BASE64_IMAGE,e,{base64:""})?L.beforeInvoke(E.Native.SAVE_BASE64_IMAGE,e):e.invalidParamObj:$(E.Native.SAVE_BASE64_IMAGE,e,"parameter error:parameter.base64 should be String instead of Undefined.")},saveFileToPhone:function(e){return e.content?e.fileName?Y(E.Native.SAVE_FILE_TO_PHONE,e,{content:"",fileName:""})?L.beforeInvoke(E.Native.SAVE_FILE_TO_PHONE,e):e.invalidParamObj:$(E.Native.SAVE_FILE_TO_PHONE,e,"parameter error:parameter.fileName should be String instead of Undefined."):$(E.Native.SAVE_FILE_TO_PHONE,e,"parameter error:parameter.content should be String instead of Undefined.")},saveImage:function(e){return e.content?Y(E.Native.SAVE_IMAGE,e,{content:""})?L.beforeInvoke(E.Native.SAVE_IMAGE,e):e.invalidParamObj:$(E.Native.SAVE_IMAGE,e,"parameter error:parameter.content should be String instead of Undefined.")},scanCode:function(e){const t=["barCode","qrCode","datamatrix","pdf417"];if((null==e?void 0:e.scanType)&&e.scanType.length>0&&!e.scanType.every((e=>t.indexOf(e)>-1)))return $(E.Native.SCAN_CODE,e,"parameter error:parameter.scanType contains invalid values.");const n=Object.assign({onlyFromCamera:!1,scanType:["barCode","qrCode"]},e);return L.beforeInvoke(E.Native.SCAN_CODE,n)},setStorage:function(e){if(!(null==e?void 0:e.key)||!e.data)return $(E.Native.SET_STORAGE,e,"parameter error:parameter.key or parameter.data should not be Undefined.");const t=Object.assign({encrypt:!1},e);return L.beforeInvoke(E.Native.SET_STORAGE,t)},showLoading:function(e){const t=Object.assign({title:"Loading...",mask:!1},e);return Y(E.Native.SHOW_LOADING,t,{title:"",mask:!1})?L.beforeInvoke(E.Native.SHOW_LOADING,t):t.invalidParamObj},showToast:function(e){var t;if(!(null==e?void 0:e.title)&&!(null==e?void 0:e.message))return $(E.Native.SHOW_TOAST,e,"parameter error: prompt message should be String instead of Undefined.");if(e.title=null!==(t=e.title)&&void 0!==t?t:e.message,Y(E.Native.SHOW_TOAST,e,{title:"",message:"",icon:"",duration:0,mask:!1,image:""})){const t=["success","error","loading","none"];if((null==e?void 0:e.icon)&&-1===t.indexOf(null==e?void 0:e.icon))return $(E.Native.SHOW_TOAST,e,"parameter error:parameter.icon contains invalid values.");const n=Object.assign({icon:"success",duration:1500,mask:!1},e);return L.beforeInvoke(E.Native.SHOW_TOAST,n)}return e.invalidParamObj},startBluetoothDevicesDiscovery:function(e){return x(E.Native.START_BLUETOOTH_DEVICES_DISCOVERY,e,{services:["1"]},{services:{optional:!0}})?L.beforeInvoke(E.Native.START_BLUETOOTH_DEVICES_DISCOVERY,e):e.invalidParamObj},stopAudio:function(e){return L.beforeInvoke(E.Native.STOP_AUOID,e)},stopBluetoothDevicesDiscovery:function(e){return L.beforeInvoke(E.Native.STOP_BLUETOOTH_DEVICES_DISCOVERY,e)},submitReport:function(e){return L.beforeInvoke(E.Native.SUBMIT_REPORT,e)},tradePay:function(e){return x(E.Native.TRADE_PAY,e,{tradeNO:"",orderStr:"",sign:"",extendParam:""},{tradeNO:z,orderStr:z,sign:z,extendParam:Z})?L.beforeInvoke(E.Native.TRADE_PAY,e):e.invalidParamObj},uploadFile:function(e){if(!e.url)return $(E.Native.UPLOAD_FILE,e,"parameter error: parameter.url should be String instead of Undefined.");if(e.files)e.filePath="",e.name="";else{if(!e.filePath)return $(E.Native.UPLOAD_FILE,e,"parameter error: parameter.filePath should be String instead of Undefined.");if(!e.name)return $(E.Native.UPLOAD_FILE,e,"parameter error: parameter.name should be String instead of Undefined.")}return L.beforeInvoke(E.Native.UPLOAD_FILE,e)},writeBLECharacteristicValue:function(e){const{deviceId:t,serviceId:n,characteristicId:r,value:i,writeType:o}=e,a={deviceId:t,serviceId:n,characteristicId:r,value:i};if(void 0!==o&&(a.writeType=o),!J(a,e,E.Native.WRITE_BLE_CHARACTERISTIC_VALUE))return e.invalidParamObj;if(Y(E.Native.WRITE_BLE_CHARACTERISTIC_VALUE,e,{deviceId:"",serviceId:"",characteristicId:"",value:new ArrayBuffer(8),writeType:""})){const t=["write","writeNoResponse","signedWrite"];if((null==e?void 0:e.writeType)&&-1===t.indexOf(null==e?void 0:e.writeType))return $(E.Native.WRITE_BLE_CHARACTERISTIC_VALUE,e,"parameter error:parameter.writeType contains invalid values.");const n=(s=e.value,Array.from(new Uint8Array(s))),r=Object.assign(Object.assign({},e),{value:n});return L.beforeInvoke(E.Native.WRITE_BLE_CHARACTERISTIC_VALUE,r)}var s;return e.invalidParamObj}});const te=Object.assign({miniProgram:Object.assign(Object.assign({},K),{navigateBackMiniProgram(){},onWebviewEvent(){},offWebviewEvent(){},sendWebviewEvent(){},onShow(){},onHide(){},onUnload(){}})},ee);return"loading"!==document.readyState?P():document.addEventListener("DOMContentLoaded",P),window.onerror=function(e,t,n,r,i){U.normalError({key:"thirdPageParamsError",message:e,file:t,line:n,column:r})},window.ma=te,window.viewLayer={onInvokeFinished:function(e,t,n){const r=_[e];"function"==typeof r&&r(t,n),2!==Number(t)&&delete _[e]},subscribeHandler:function(e,t){return(0,g[e])(t)}},te}));
